import{r as V,m as T,n as U,d as h,o as F,f as a,g as n,h as y,H as D,E as G,e,t,k as x,K as H,ac as J,J as j}from"./index-BI8oO-SX.js";import{_ as q}from"./_plugin-vue_export-helper-DlAUqK2U.js";const z={class:"system-monitor"},L={class:"stack-column"},O={class:"card-content vertical"},Q={class:"metric-summary"},R={class:"card-content vertical"},W={class:"metric-summary"},X={class:"update-info"},Y={class:"stack-column"},Z={class:"card-content"},ee={class:"progress-value"},se={class:"metric-list"},le={key:0,class:"cpu-description"},te={__name:"SystemMonitor",setup(ae){const l=V(null),B=V(!1);let N=null;const w=async()=>{var r,s;B.value=!0;try{const{data:o}=await D.get("/system/metrics");l.value=o}catch(o){G.error(((s=(r=o.response)==null?void 0:r.data)==null?void 0:s.error)||"获取系统监控数据失败")}finally{B.value=!1}},P=()=>{w()},C=r=>r==null||Number.isNaN(r)?"-":`${Number(r).toFixed(1)}%`,g=r=>{if(!r||Number.isNaN(r))return"-";const s=["B","KB","MB","GB","TB","PB"];let o=Number(r),u=0;for(;o>=1024&&u<s.length-1;)o/=1024,u++;return`${o.toFixed(2)} ${s[u]}`};return T(()=>{w(),N=setInterval(w,5e3)}),U(()=>{N&&(clearInterval(N),N=null)}),(r,s)=>{const o=y("el-progress"),u=y("el-card"),S=y("el-icon"),$=y("el-button"),M=y("el-col"),A=y("el-row");return F(),h("div",z,[a(A,{gutter:20},{default:n(()=>[a(M,{xs:24,sm:24,md:12,lg:12},{default:n(()=>[e("div",L,[a(u,{class:"metric-card"},{header:n(()=>[...s[0]||(s[0]=[e("div",{class:"card-header"},[e("span",null,"内存使用情况")],-1)])]),default:n(()=>{var d,i,c,p,m,v,_,f;return[e("div",O,[a(o,{percentage:((i=(d=l.value)==null?void 0:d.memory)==null?void 0:i.percent)||0,"stroke-width":18,color:"#67C23A",class:"linear-progress"},null,8,["percentage"]),e("div",Q,[e("div",null,[s[1]||(s[1]=e("span",{class:"label"},"总计",-1)),e("span",null,t(g((p=(c=l.value)==null?void 0:c.memory)==null?void 0:p.total)),1)]),e("div",null,[s[2]||(s[2]=e("span",{class:"label"},"已用",-1)),e("span",null,t(g((v=(m=l.value)==null?void 0:m.memory)==null?void 0:v.used)),1)]),e("div",null,[s[3]||(s[3]=e("span",{class:"label"},"可用",-1)),e("span",null,t(g((f=(_=l.value)==null?void 0:_.memory)==null?void 0:f.free)),1)])])])]}),_:1}),a(u,{class:"metric-card"},{header:n(()=>[...s[4]||(s[4]=[e("div",{class:"card-header"},[e("span",null,"磁盘使用率")],-1)])]),default:n(()=>{var d,i,c,p,m,v,_,f,k,b;return[e("div",R,[a(o,{percentage:((i=(d=l.value)==null?void 0:d.disk)==null?void 0:i.percent)||0,"stroke-width":18,color:"#E6A23C",class:"linear-progress"},null,8,["percentage"]),e("div",W,[e("div",null,[s[5]||(s[5]=e("span",{class:"label"},"挂载点",-1)),e("span",null,t(((p=(c=l.value)==null?void 0:c.disk)==null?void 0:p.path)||"/"),1)]),e("div",null,[s[6]||(s[6]=e("span",{class:"label"},"总计",-1)),e("span",null,t(g((v=(m=l.value)==null?void 0:m.disk)==null?void 0:v.total)),1)]),e("div",null,[s[7]||(s[7]=e("span",{class:"label"},"已用",-1)),e("span",null,t(g((f=(_=l.value)==null?void 0:_.disk)==null?void 0:f.used)),1)]),e("div",null,[s[8]||(s[8]=e("span",{class:"label"},"可用",-1)),e("span",null,t(g((b=(k=l.value)==null?void 0:k.disk)==null?void 0:b.free)),1)])])])]}),_:1}),a(u,{class:"metric-card update-card stacked"},{default:n(()=>{var d;return[e("div",X,[e("span",null,"最近更新时间："+t(((d=l.value)==null?void 0:d.updated_at)||"-"),1),a($,{type:"primary",text:"",loading:B.value,onClick:P},{default:n(()=>[a(S,null,{default:n(()=>[a(H(J))]),_:1}),s[9]||(s[9]=x(" 立即刷新 ",-1))]),_:1},8,["loading"])])]}),_:1})])]),_:1}),a(M,{xs:24,sm:24,md:12,lg:12},{default:n(()=>[e("div",Y,[a(u,{class:"metric-card cpu-card"},{header:n(()=>[...s[10]||(s[10]=[e("div",{class:"card-header"},[e("span",null,"CPU 使用率")],-1)])]),default:n(()=>{var d,i,c,p,m,v,_,f,k,b,E,I;return[e("div",Z,[a(o,{type:"dashboard",percentage:((i=(d=l.value)==null?void 0:d.cpu)==null?void 0:i.usage)||0,width:180,"stroke-width":12},{default:n(({percentage:K})=>[e("span",ee,t(K.toFixed(1))+"%",1)]),_:1},8,["percentage"]),e("ul",se,[e("li",null,[s[11]||(s[11]=e("span",null,"核心数：",-1)),x(t(((p=(c=l.value)==null?void 0:c.cpu)==null?void 0:p.cores)||"-"),1)]),e("li",null,[s[12]||(s[12]=e("span",null,"用户态：",-1)),x(t(C((v=(m=l.value)==null?void 0:m.cpu)==null?void 0:v.user)),1)]),e("li",null,[s[13]||(s[13]=e("span",null,"内核态：",-1)),x(t(C((f=(_=l.value)==null?void 0:_.cpu)==null?void 0:f.system)),1)]),e("li",null,[s[14]||(s[14]=e("span",null,"空闲：",-1)),x(t(C((b=(k=l.value)==null?void 0:k.cpu)==null?void 0:b.idle)),1)])])]),(I=(E=l.value)==null?void 0:E.cpu)!=null&&I.description?(F(),h("div",le,t(l.value.cpu.description),1)):j("",!0)]}),_:1})])]),_:1})]),_:1})])}}},oe=q(te,[["__scopeId","data-v-47c3f6db"]]);export{oe as default};
