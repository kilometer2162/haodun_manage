import{r as i,b as h,m as _e,d as q,o as b,e as M,f as t,g as a,h as r,H as f,E as m,a2 as Ve,k as u,M as ee,p as U,t as T,K as Ce,Q as le,R as te,a3 as ae}from"./index-BI8oO-SX.js";import{f as ke}from"./date-B59vURDm.js";import{_ as xe}from"./_plugin-vue_export-helper-DlAUqK2U.js";const ze={class:"dicts-page"},Ue={class:"page-header"},Te={style:{margin:"20px 0"}},we={__name:"Dicts",setup($e){const oe=ke,w=i("types"),$=i(!1),D=i(!1),x=i([]),O=i([]),g=i(null),I=i(1),S=i(10),L=i(0),j=i(1),F=i(10),N=i(0),_=i(!1),V=i(!1),R=i("新增字典类型"),B=i("新增字典项"),E=i(null),P=i(null),p=h({id:null,code:"",name:"",description:"",status:1}),n=h({id:null,type_id:null,label:"",value:"",sort:0,status:1,description:""}),se={code:[{required:!0,message:"请输入代码",trigger:"blur"}],name:[{required:!0,message:"请输入名称",trigger:"blur"}]},ne={type_id:[{required:!0,message:"请选择字典类型",trigger:"change"}],label:[{required:!0,message:"请输入标签",trigger:"blur"}],value:[{required:!0,message:"请输入值",trigger:"blur"}]},k=async()=>{$.value=!0;try{const o=await f.get(`/dict-types?page=${I.value}&page_size=${S.value}`);x.value=o.data.data,L.value=o.data.total}catch{m.error("加载字典类型列表失败")}finally{$.value=!1}},c=async()=>{D.value=!0;try{let o=`/dict-items?page=${j.value}&page_size=${F.value}`;g.value&&(o+=`&type_id=${g.value}`);const e=await f.get(o);O.value=e.data.data,N.value=e.data.total}catch{m.error("加载字典项列表失败")}finally{D.value=!1}},de=o=>{o==="items"&&c()},ue=()=>{R.value="新增字典类型",Object.assign(p,{id:null,code:"",name:"",description:"",status:1}),_.value=!0},ie=o=>{R.value="编辑字典类型",Object.assign(p,{id:o.id,code:o.code,name:o.name,description:o.description,status:o.status}),_.value=!0},re=async o=>{var e,d;try{await ae.confirm("确定要删除该字典类型吗？","提示",{type:"warning"}),await f.delete(`/dict-types/${o.id}`),m.success("删除成功"),k()}catch(s){s!=="cancel"&&m.error(((d=(e=s.response)==null?void 0:e.data)==null?void 0:d.error)||"删除失败")}},pe=o=>{w.value="items",g.value=o.id,c()},me=()=>{B.value="新增字典项",Object.assign(n,{id:null,type_id:g.value,label:"",value:"",sort:0,status:1,description:""}),V.value=!0},ve=o=>{B.value="编辑字典项",Object.assign(n,{id:o.id,type_id:o.type_id,label:o.label,value:o.value,sort:o.sort,status:o.status,description:o.description}),V.value=!0},fe=async o=>{try{await ae.confirm("确定要删除该字典项吗？","提示",{type:"warning"}),await f.delete(`/dict-items/${o.id}`),m.success("删除成功"),c()}catch(e){e!=="cancel"&&m.error("删除失败")}},ge=async()=>{E.value&&await E.value.validate(async o=>{var e,d;if(o)try{p.id?(await f.put(`/dict-types/${p.id}`,p),m.success("更新成功")):(await f.post("/dict-types",p),m.success("创建成功")),_.value=!1,k()}catch(s){m.error(((d=(e=s.response)==null?void 0:e.data)==null?void 0:d.error)||"操作失败")}})},ce=async()=>{P.value&&await P.value.validate(async o=>{var e,d;if(o)try{n.id?(await f.put(`/dict-items/${n.id}`,n),m.success("更新成功")):(await f.post("/dict-items",n),m.success("创建成功")),V.value=!1,c()}catch(s){m.error(((d=(e=s.response)==null?void 0:e.data)==null?void 0:d.error)||"操作失败")}})};return _e(()=>{k()}),(o,e)=>{const d=r("el-button"),s=r("el-table-column"),A=r("el-tag"),H=r("el-table"),K=r("el-pagination"),Q=r("el-tab-pane"),G=r("el-option"),J=r("el-select"),ye=r("el-tabs"),C=r("el-input"),v=r("el-form-item"),z=r("el-radio"),W=r("el-radio-group"),X=r("el-form"),Y=r("el-dialog"),be=r("el-input-number"),Z=Ve("loading");return b(),q("div",ze,[M("div",Ue,[e[21]||(e[21]=M("h2",null,"系统字典管理",-1)),t(d,{type:"primary",onClick:ue},{default:a(()=>[...e[20]||(e[20]=[u("新增字典类型",-1)])]),_:1})]),t(ye,{modelValue:w.value,"onUpdate:modelValue":e[5]||(e[5]=l=>w.value=l),onTabChange:de},{default:a(()=>[t(Q,{label:"字典类型",name:"types"},{default:a(()=>[ee((b(),U(H,{data:x.value,style:{"margin-top":"20px"}},{default:a(()=>[t(s,{prop:"code",label:"代码",width:"150"}),t(s,{prop:"name",label:"名称"}),t(s,{prop:"description",label:"描述"}),t(s,{label:"字典项数量",width:"120"},{default:a(({row:l})=>{var y;return[u(T(((y=l.items)==null?void 0:y.length)||0),1)]}),_:1}),t(s,{label:"状态",width:"100"},{default:a(({row:l})=>[t(A,{type:l.status===1?"success":"danger"},{default:a(()=>[u(T(l.status===1?"启用":"禁用"),1)]),_:2},1032,["type"])]),_:1}),t(s,{prop:"created_at",label:"创建时间",width:"180"},{default:a(({row:l})=>[u(T(Ce(oe)(l.created_at)),1)]),_:1}),t(s,{label:"操作",width:"250"},{default:a(({row:l})=>[t(d,{size:"small",onClick:y=>ie(l)},{default:a(()=>[...e[22]||(e[22]=[u("编辑",-1)])]),_:1},8,["onClick"]),t(d,{size:"small",onClick:y=>pe(l)},{default:a(()=>[...e[23]||(e[23]=[u("管理字典项",-1)])]),_:1},8,["onClick"]),t(d,{size:"small",type:"danger",onClick:y=>re(l)},{default:a(()=>[...e[24]||(e[24]=[u("删除",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[Z,$.value]]),t(K,{"current-page":I.value,"onUpdate:currentPage":e[0]||(e[0]=l=>I.value=l),"page-size":S.value,"onUpdate:pageSize":e[1]||(e[1]=l=>S.value=l),total:L.value,"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next, jumper",onSizeChange:k,onCurrentChange:k,style:{"margin-top":"20px"}},null,8,["current-page","page-size","total"])]),_:1}),t(Q,{label:"字典项",name:"items"},{default:a(()=>[M("div",Te,[t(J,{modelValue:g.value,"onUpdate:modelValue":e[2]||(e[2]=l=>g.value=l),placeholder:"请选择字典类型",clearable:"",onChange:c,style:{width:"300px"}},{default:a(()=>[(b(!0),q(le,null,te(x.value,l=>(b(),U(G,{key:l.id,label:l.name,value:l.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),t(d,{type:"primary",onClick:me,disabled:!g.value,style:{"margin-left":"10px"}},{default:a(()=>[...e[25]||(e[25]=[u(" 新增字典项 ",-1)])]),_:1},8,["disabled"])]),ee((b(),U(H,{data:O.value,style:{"margin-top":"20px"}},{default:a(()=>[t(s,{prop:"sort",label:"排序",width:"80"}),t(s,{prop:"type.name",label:"字典类型",width:"150"}),t(s,{prop:"label",label:"标签"}),t(s,{prop:"value",label:"值",width:"120"}),t(s,{label:"状态",width:"100"},{default:a(({row:l})=>[t(A,{type:l.status===1?"success":"danger"},{default:a(()=>[u(T(l.status===1?"启用":"禁用"),1)]),_:2},1032,["type"])]),_:1}),t(s,{prop:"description",label:"描述"}),t(s,{label:"操作",width:"200"},{default:a(({row:l})=>[t(d,{size:"small",onClick:y=>ve(l)},{default:a(()=>[...e[26]||(e[26]=[u("编辑",-1)])]),_:1},8,["onClick"]),t(d,{size:"small",type:"danger",onClick:y=>fe(l)},{default:a(()=>[...e[27]||(e[27]=[u("删除",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[Z,D.value]]),t(K,{"current-page":j.value,"onUpdate:currentPage":e[3]||(e[3]=l=>j.value=l),"page-size":F.value,"onUpdate:pageSize":e[4]||(e[4]=l=>F.value=l),total:N.value,"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next, jumper",onSizeChange:c,onCurrentChange:c,style:{"margin-top":"20px"}},null,8,["current-page","page-size","total"])]),_:1})]),_:1},8,["modelValue"]),t(Y,{modelValue:_.value,"onUpdate:modelValue":e[11]||(e[11]=l=>_.value=l),title:R.value,width:"500px"},{footer:a(()=>[t(d,{onClick:e[10]||(e[10]=l=>_.value=!1)},{default:a(()=>[...e[30]||(e[30]=[u("取消",-1)])]),_:1}),t(d,{type:"primary",onClick:ge},{default:a(()=>[...e[31]||(e[31]=[u("确定",-1)])]),_:1})]),default:a(()=>[t(X,{model:p,rules:se,ref_key:"typeFormRef",ref:E,"label-width":"100px"},{default:a(()=>[t(v,{label:"代码",prop:"code"},{default:a(()=>[t(C,{modelValue:p.code,"onUpdate:modelValue":e[6]||(e[6]=l=>p.code=l),placeholder:"如：user_status"},null,8,["modelValue"])]),_:1}),t(v,{label:"名称",prop:"name"},{default:a(()=>[t(C,{modelValue:p.name,"onUpdate:modelValue":e[7]||(e[7]=l=>p.name=l),placeholder:"如：用户状态"},null,8,["modelValue"])]),_:1}),t(v,{label:"描述",prop:"description"},{default:a(()=>[t(C,{modelValue:p.description,"onUpdate:modelValue":e[8]||(e[8]=l=>p.description=l),type:"textarea"},null,8,["modelValue"])]),_:1}),t(v,{label:"状态",prop:"status"},{default:a(()=>[t(W,{modelValue:p.status,"onUpdate:modelValue":e[9]||(e[9]=l=>p.status=l)},{default:a(()=>[t(z,{value:1},{default:a(()=>[...e[28]||(e[28]=[u("启用",-1)])]),_:1}),t(z,{value:0},{default:a(()=>[...e[29]||(e[29]=[u("禁用",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"]),t(Y,{modelValue:V.value,"onUpdate:modelValue":e[19]||(e[19]=l=>V.value=l),title:B.value,width:"500px"},{footer:a(()=>[t(d,{onClick:e[18]||(e[18]=l=>V.value=!1)},{default:a(()=>[...e[34]||(e[34]=[u("取消",-1)])]),_:1}),t(d,{type:"primary",onClick:ce},{default:a(()=>[...e[35]||(e[35]=[u("确定",-1)])]),_:1})]),default:a(()=>[t(X,{model:n,rules:ne,ref_key:"itemFormRef",ref:P,"label-width":"100px"},{default:a(()=>[t(v,{label:"字典类型",prop:"type_id"},{default:a(()=>[t(J,{modelValue:n.type_id,"onUpdate:modelValue":e[12]||(e[12]=l=>n.type_id=l),placeholder:"请选择字典类型",disabled:!!n.id},{default:a(()=>[(b(!0),q(le,null,te(x.value,l=>(b(),U(G,{key:l.id,label:l.name,value:l.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","disabled"])]),_:1}),t(v,{label:"标签",prop:"label"},{default:a(()=>[t(C,{modelValue:n.label,"onUpdate:modelValue":e[13]||(e[13]=l=>n.label=l),placeholder:"如：正常"},null,8,["modelValue"])]),_:1}),t(v,{label:"值",prop:"value"},{default:a(()=>[t(C,{modelValue:n.value,"onUpdate:modelValue":e[14]||(e[14]=l=>n.value=l),placeholder:"如：1"},null,8,["modelValue"])]),_:1}),t(v,{label:"排序",prop:"sort"},{default:a(()=>[t(be,{modelValue:n.sort,"onUpdate:modelValue":e[15]||(e[15]=l=>n.sort=l),min:0},null,8,["modelValue"])]),_:1}),t(v,{label:"状态",prop:"status"},{default:a(()=>[t(W,{modelValue:n.status,"onUpdate:modelValue":e[16]||(e[16]=l=>n.status=l)},{default:a(()=>[t(z,{value:1},{default:a(()=>[...e[32]||(e[32]=[u("启用",-1)])]),_:1}),t(z,{value:0},{default:a(()=>[...e[33]||(e[33]=[u("禁用",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1}),t(v,{label:"描述",prop:"description"},{default:a(()=>[t(C,{modelValue:n.description,"onUpdate:modelValue":e[17]||(e[17]=l=>n.description=l),type:"textarea"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}},je=xe(we,[["__scopeId","data-v-2d86ce4c"]]);export{je as default};
